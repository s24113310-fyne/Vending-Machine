<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Elegant Jewelry Vending Machine âœ¨</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap');
  body {
    font-family: 'Montserrat', sans-serif;
    margin: 0;
    padding: 40px 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    color: #5a1a7e;
    background: linear-gradient(135deg, #f8d7e3, #f9e8ef);
    overflow: hidden;
    position: relative;
  }
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image:
      radial-gradient(2px 2px at 10% 20%, rgba(255 255 255 / 0.8), transparent 60%),
      radial-gradient(1.5px 1.5px at 25% 40%, rgba(255 255 255 / 0.6), transparent 60%),
      radial-gradient(2px 2px at 50% 10%, rgba(255 255 255 / 0.7), transparent 60%),
      radial-gradient(1.8px 1.8px at 70% 80%, rgba(255 255 255 / 0.5), transparent 60%),
      radial-gradient(1.5px 1.5px at 85% 30%, rgba(255 255 255 / 0.6), transparent 60%);
    background-repeat: repeat;
    background-size: 200px 200px;
    animation: glitterMove 15s linear infinite;
    z-index: 0;
    pointer-events: none;
  }
  @keyframes glitterMove { 0% { background-position: 0 0; } 100% { background-position: 200px 200px; } }

  .container {
    display: flex;
    background: #fff0fc;
    border-radius: 30px;
    box-shadow: 0 20px 40px rgba(135, 20, 105, 0.3);
    max-width: 1100px;
    width: 100%;
    padding: 40px 50px;
    color: #5a1a7e;
    position: relative;
    z-index: 1;
  }

  h1 {
    font-size: 3rem;
    margin-bottom: 40px;
    font-weight: 900;
    letter-spacing: 3px;
    color: #8e2ad6;
    text-shadow: 0 3px 10px rgba(142, 42, 214, 0.5);
    position: relative;
  }

  h1::after {
    content: "ðŸ’Žâœ¨";
    margin-left: 12px;
    animation: sparkle 2s ease-in-out infinite alternate;
  }
  @keyframes sparkle { 0% { opacity: 0.4; transform: scale(1); } 100% { opacity: 1; transform: scale(1.4) rotate(5deg); } }

  .vending-machine { flex: 1; text-align: center; }
  .items-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 40px; }

  .item-card {
    background: #fff4fc;
    border-radius: 20px;
    padding: 20px 15px 30px;
    box-shadow: 0 8px 15px rgba(142, 42, 214, 0.15);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .item-card:hover { transform: translateY(-10px) scale(1.05); box-shadow: 0 20px 40px rgba(142, 42, 214, 0.5); border: 2px solid #8e2ad6; }

  .item-emoji { font-size: 3rem; margin-bottom: 10px; }
  .item-name { font-weight: 700; font-size: 1.2rem; color: #6a1b9a; margin-bottom: 10px; }
  .item-price {
    font-weight: 800; font-size: 1.2rem;
    background: linear-gradient(90deg, #d15eff, #8e2ad6);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    margin-bottom: 15px;
  }
  .buy-btn {
    background: linear-gradient(45deg, #8e2ad6, #5a1a7e);
    color: white; border: none; border-radius: 18px;
    padding: 10px 20px; font-weight: 800;
    box-shadow: 0 6px 15px rgba(142, 42, 214, 0.5);
    cursor: pointer; transition: transform 0.2s ease;
  }
  .buy-btn:hover { transform: scale(1.1); }

  .balance { font-size: 1.8rem; font-weight: 900; color: #7a1fa2; margin-bottom: 10px; }
  .message { min-height: 32px; font-weight: 700; font-size: 1.2rem; margin-bottom: 25px; color: #aa33cc; }

  .keypad {
    width: 250px; background: #f5e1f7;
    border-radius: 30px; box-shadow: 0 15px 40px rgba(135, 20, 105, 0.25);
    padding: 30px 20px; margin-left: 40px;
    display: flex; flex-direction: column; align-items: center;
  }
  /* Coins + slot styles */
  .coins-container {
    display: flex;
    gap: 10px;
    margin-bottom: 18px;
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
  }
  .coin {
    width: 54px; height: 54px; border-radius: 50%;
    display: inline-flex; align-items: center; justify-content: center;
    color: white; font-weight: 900; cursor: grab; user-select: none;
    box-shadow: 0 6px 12px rgba(0,0,0,0.12);
    border: 3px solid rgba(255,255,255,0.12);
    transition: transform 0.14s ease, box-shadow 0.14s ease;
  }
  .coin:active { cursor: grabbing; transform: scale(0.98); }
  .coin.small { width: 46px; height: 46px; font-size: 0.9rem; }

  .coin.slot-10 { background: linear-gradient(135deg,#ffd46a,#ffb84d); color:#512500 }
  .coin.slot-50 { background: linear-gradient(135deg,#ffd29a,#ff8c4f); }
  .coin.slot-100 { background: linear-gradient(135deg,#b6f0ff,#5bd4ff); color:#003b45 }
  .coin.slot-500 { background: linear-gradient(135deg,#e2c6ff,#c08eff); }
  .coin.slot-1000 { background: linear-gradient(135deg,#ffd6f0,#ff9adf); }

  .coin-slot {
    width: 100%; height: 56px; border-radius: 12px; background: linear-gradient(180deg,#f1dff3,#fbeefb);
    border: 2px dashed rgba(122,31,162,0.18); display:flex; align-items:center; justify-content:center;
    color:#7a1fa2; font-weight:800; margin-bottom:14px; position: relative; overflow: visible;
    transition: box-shadow 0.12s ease, transform 0.12s ease, border-color 0.12s ease;
  }
  .coin-slot::after {
    content: 'Insert Coin Here'; position:absolute; left:12px; top:8px; font-size:0.8rem; opacity:0.85; font-weight:700;
  }
  .coin-slot.active { box-shadow: 0 6px 18px rgba(138, 45, 170, 0.15); transform: translateY(-2px); border-color: rgba(142,42,214,0.45); }

  /* floating clone used for animation */
  .coin-clone { position: absolute; pointer-events: none; z-index: 20000; border-radius: 50%; display:flex; align-items:center; justify-content:center; }
  .insert-title { font-weight: 900; font-size: 1.3rem; margin-bottom: 20px; color: #7a1fa2; }
  .money-buttons {
    display: grid; grid-template-columns: repeat(2, 1fr);
    gap: 15px; width: 100%;
  }
  .money-btn {
    background: linear-gradient(45deg, #8e2ad6, #5a1a7e);
    color: white; border: none; border-radius: 20px;
    font-size: 1.2rem; font-weight: 900; padding: 15px 0;
    cursor: pointer; box-shadow: 0 8px 18px rgba(142, 42, 214, 0.6);
    transition: transform 0.2s ease;
  }
  .money-btn:hover { transform: scale(1.1); }

  .floating-item {
    position: absolute;
    font-size: 2.5rem;
    animation: floatUp 5s ease-in-out forwards;
    opacity: 0;
    z-index: 999;
  }
  @keyframes floatUp {
    0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
    100% { opacity: 0; transform: translateY(-300px) scale(1.5) rotate(360deg); }
  }

  /* Receipt popup */
  .receipt {
    position: fixed;
    bottom: 40px;
    right: 40px;
    background: white;
    border-radius: 20px;
    padding: 25px 30px;
    box-shadow: 0 10px 30px rgba(142, 42, 214, 0.3);
    color: #5a1a7e;
    font-weight: 600;
    animation: fadeIn 0.4s ease;
    z-index: 10000;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="vending-machine">
      <h1>Jewelry Vending Machine</h1>
      <div class="items-grid" id="itemsGrid"></div>
      <div class="balance" id="balanceDisplay">Balance: NTD 0.00</div>
      <div class="message" id="message"></div>
    </div>

    <div class="keypad">
      <div class="insert-title">Insert Money ðŸ’°</div>
        <!-- visual coin slot + draggable coins -->
        <div class="coin-slot" id="coinSlot" aria-label="Coin slot" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)"></div>

        <div class="coins-container" id="coinsContainer" aria-hidden="false"></div>

        <div style="width:100%; height:8px"></div>
        <div class="money-buttons">
          <button class="money-btn" onclick="insertMoney(10)">NTD 10</button>
          <button class="money-btn" onclick="insertMoney(50)">NTD 50</button>
          <button class="money-btn" onclick="insertMoney(100)">NTD 100</button>
          <button class="money-btn" onclick="insertMoney(500)">NTD 500</button>
          <button class="money-btn" style="grid-column: span 2;" onclick="insertMoney(1000)">NTD 1000</button>
        </div>
    </div>
  </div>

  <!-- Sound effects -->
  <audio id="coinSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_c71de28a1d.mp3"></audio>
  <audio id="buySound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_5e19e9db5a.mp3"></audio>

<script>
  const items = [
    { name: 'Diamond Ring', price: 55, emoji: 'ðŸ’' },
    { name: 'Gold Necklace', price: 80, emoji: 'ðŸ“¿' },
    { name: 'Silver Bracelet', price: 45, emoji: 'ðŸ§¿' },
    { name: 'Pearl Earrings', price: 50, emoji: 'ðŸ‘‚' },
    { name: 'Emerald Anklet', price: 60, emoji: 'ðŸ¦¶' },
    { name: 'Belly Accessory', price: 70, emoji: 'ðŸ’«' }
  ];

  let balance = 0;
  const balanceDisplay = document.getElementById('balanceDisplay');
  const message = document.getElementById('message');
  const itemsGrid = document.getElementById('itemsGrid');
  const coinSound = document.getElementById('coinSound');
  const buySound = document.getElementById('buySound');

  // drag-and-drop coin support
  const coinsContainerEl = document.getElementById('coinsContainer');
  const coinSlotEl = document.getElementById('coinSlot');

  function createCoinElements() {
    const denoms = [10,50,100,500,1000];
    coinsContainerEl.innerHTML = '';
    denoms.forEach(d => {
      const c = document.createElement('div');
      c.className = `coin slot-${d}`;
      c.draggable = true;
      c.setAttribute('role','button');
      c.setAttribute('aria-label', `NTD ${d}`);
      c.dataset.amount = d;
      c.textContent = d === 1000 ? '1k' : d;
      c.addEventListener('dragstart', handleDragStart);
      c.addEventListener('dragend', handleDragEnd);
      // also support click to insert (keyboard/touch fallback)
      c.addEventListener('click', () => {
        animateCoinInsertAtCenter(c, d);
        insertMoney(d);
      });
      coinsContainerEl.appendChild(c);
    });
  }

  function handleDragStart(e) {
    const amount = e.target.dataset.amount || e.target.getAttribute('data-amount');
    e.dataTransfer.setData('text/plain', amount);
    // create a drag image so cursor shows coin
    const crt = e.target.cloneNode(true);
    crt.style.width = '54px'; crt.style.height = '54px';
    crt.style.transform = 'translate(-10px,-10px)';
    document.body.appendChild(crt);
    e.dataTransfer.setDragImage(crt, 27, 27);
    // remove created drag image after a short timeout (some browsers keep it)
    setTimeout(() => crt.remove(), 0);
  }

  function handleDragEnd(e) {
    // nothing for now
  }

  function handleDragOver(e) {
    e.preventDefault();
    coinSlotEl.classList.add('active');
  }

  function handleDragLeave(e) {
    coinSlotEl.classList.remove('active');
  }

  function handleDrop(e) {
    e.preventDefault();
    coinSlotEl.classList.remove('active');
    const amount = parseInt(e.dataTransfer.getData('text/plain'), 10);
    if (!isNaN(amount) && amount > 0) {
      // animate a cloned coin from drop point into the slot
      const clientX = e.clientX;
      const clientY = e.clientY;
      animateCoinToSlot(clientX, clientY, amount);
      // delay actual money insertion so animation is noticeable
      setTimeout(() => insertMoney(amount), 240);
    }
  }

  function animateCoinToSlot(startX, startY, amount) {
    const clone = document.createElement('div');
    clone.className = 'coin-clone coin slot-' + amount;
    clone.textContent = amount === 1000 ? '1k' : amount;
    clone.style.left = (startX - 28) + 'px';
    clone.style.top = (startY - 28) + 'px';
    clone.style.width = '54px'; clone.style.height = '54px';
    clone.style.fontSize = '1rem';
    clone.style.transition = 'transform 260ms ease, opacity 260ms ease, left 260ms ease, top 260ms ease';
    document.body.appendChild(clone);

    const slotRect = coinSlotEl.getBoundingClientRect();
    const targetX = slotRect.left + slotRect.width / 2 - 27;
    const targetY = slotRect.top + slotRect.height / 2 - 27;

    // force layout then move
    requestAnimationFrame(() => {
      clone.style.left = targetX + 'px';
      clone.style.top = targetY + 'px';
      clone.style.transform = 'scale(0.6) translateY(6px)';
      clone.style.opacity = '0.8';
    });

    setTimeout(() => {
      clone.style.opacity = '0';
      setTimeout(() => clone.remove(), 300);
    }, 300);
  }

  function animateCoinInsertAtCenter(element, amount) {
    const rect = element.getBoundingClientRect();
    animateCoinToSlot(rect.left + rect.width/2, rect.top + rect.height/2, amount);
  }


  function playSound(sound) {
    sound.currentTime = 0;
    sound.play();
  }

  function renderItems() {
    itemsGrid.innerHTML = '';
    items.forEach((item, index) => {
      const card = document.createElement('div');
      card.className = 'item-card';
      card.innerHTML = `
        <div class="item-emoji">${item.emoji}</div>
        <div class="item-name">${item.name}</div>
        <div class="item-price">NTD ${item.price.toFixed(2)}</div>
        <button class="buy-btn" onclick="buyItem(${index})">Buy</button>
      `;
      itemsGrid.appendChild(card);
    });
  }

  // initialize coins UI
  createCoinElements();

  function insertMoney(amount) {
    playSound(coinSound);
    balance += amount;
    updateBalance();
    showMessage(`Inserted NTD ${amount}! ðŸ’°`);
  }

  function buyItem(index) {
    const item = items[index];
    if (balance < item.price) {
      showMessage('Insufficient balance!');
      return;
    }
    balance -= item.price;
    updateBalance();
    playSound(buySound);
    showMessage(`You bought: ${item.name} ðŸ’–`);
    createFloatingShower(item.emoji);

    setTimeout(() => {
      const wantsReceipt = confirm('Would you like a receipt? ðŸ§¾');
      if (wantsReceipt) showReceipt(item);
      else showMessage('Thank you for your purchase! ðŸ’•');
    }, 1500);
  }

  function updateBalance() {
    balanceDisplay.textContent = `Balance: NTD ${balance.toFixed(2)}`;
  }

  function showMessage(msg) {
    message.textContent = msg;
    clearTimeout(showMessage.timeout);
    showMessage.timeout = setTimeout(() => message.textContent = '', 4000);
  }

  // LOTS of floating emojis (only the one you bought)
  function createFloatingShower(emoji) {
    const count = 60 + Math.random() * 40;
    for (let i = 0; i < count; i++) {
      const el = document.createElement('div');
      el.className = 'floating-item';
      el.textContent = emoji;
      el.style.left = Math.random() * window.innerWidth + 'px';
      el.style.bottom = Math.random() * 80 + 'px';
      el.style.fontSize = (2 + Math.random() * 2.5) + 'rem';
      el.style.animationDuration = (3 + Math.random() * 2) + 's';
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 5500);
    }
  }

  // Receipt pop-up
  function showReceipt(item) {
    const receipt = document.createElement('div');
    receipt.className = 'receipt';
    const now = new Date();
    receipt.innerHTML = `
      <strong>ðŸ§¾ Jewelry Vending Machine</strong><br><br>
      Item: ${item.name} ${item.emoji}<br>
      Price: NTD ${item.price.toFixed(2)}<br>
      Remaining Balance: NTD ${balance.toFixed(2)}<br><br>
      Time: ${now.toLocaleTimeString()}<br>
      Date: ${now.toLocaleDateString()}<br><br>
      ðŸ’– Thank you for your purchase!
    `;
    document.body.appendChild(receipt);
    setTimeout(() => receipt.remove(), 8000);
  }

  renderItems();
  updateBalance();
</script>
</body>
</html>
